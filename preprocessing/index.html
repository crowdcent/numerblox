
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../numerframe/">
      
      
        <link rel="next" href="../targets/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.8">
    
    
      
        <title>Preprocessing - numerblox</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4b4a2bd9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="005380">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#preprocessors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="numerblox" class="md-header__button md-logo" aria-label="numerblox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 9V1.5h-3V9h-3V1.5h-3V9h-3V1.5H4.65V9H3v1.5h18V9h-1.5m0 4.5h-3V21h-3v-7.5h-3V21h-3v-7.5H4.65V21H3v1.5h18V21h-1.5v-7.5Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            numerblox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Preprocessing
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../end_to_end/" class="md-tabs__link">
        
  
    
  
  End-To-End Examples

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../download/" class="md-tabs__link">
        
  
    
  
  Downloaders

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../numerframe/" class="md-tabs__link">
        
  
    
  
  NumerFrame

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Preprocessing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../targets/" class="md-tabs__link">
        
  
    
  
  Target Engineering

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../meta/" class="md-tabs__link">
        
  
    
  
  Meta Estimators

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../neutralization/" class="md-tabs__link">
        
  
    
  
  Feature Neutralization

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../penalization/" class="md-tabs__link">
        
  
    
  
  Feature Penalization

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../prediction_loaders/" class="md-tabs__link">
        
  
    
  
  Prediction Loaders

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../evaluation/" class="md-tabs__link">
        
  
    
  
  Evaluation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../submission/" class="md-tabs__link">
        
  
    
  
  Submitters

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  How To Contribute

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../crowdcent/" class="md-tabs__link">
        
  
    
  
  About CrowdCent

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../disclaimer/" class="md-tabs__link">
        
  
    
  
  Disclaimer

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
    
  
  API Reference

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="numerblox" class="md-nav__button md-logo" aria-label="numerblox" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19.5 9V1.5h-3V9h-3V1.5h-3V9h-3V1.5H4.65V9H3v1.5h18V9h-1.5m0 4.5h-3V21h-3v-7.5h-3V21h-3v-7.5H4.65V21H3v1.5h18V21h-1.5v-7.5Z"/></svg>

    </a>
    numerblox
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../end_to_end/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    End-To-End Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloaders
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../numerframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumerFrame
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Preprocessing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#numerai-classic" class="md-nav__link">
    Numerai Classic
  </a>
  
    <nav class="md-nav" aria-label="Numerai Classic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupstatspreprocessor" class="md-nav__link">
    GroupStatsPreProcessor
  </a>
  
    <nav class="md-nav" aria-label="GroupStatsPreProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerai-signals" class="md-nav__link">
    Numerai Signals
  </a>
  
    <nav class="md-nav" aria-label="Numerai Signals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reducememoryprocessor" class="md-nav__link">
    ReduceMemoryProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#katsufeaturegenerator" class="md-nav__link">
    KatsuFeatureGenerator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eraquantileprocessor" class="md-nav__link">
    EraQuantileProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tickermapper" class="md-nav__link">
    TickerMapper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lagpreprocessor" class="md-nav__link">
    LagPreProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differencepreprocessor" class="md-nav__link">
    DifferencePreProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pandastafeaturegenerator" class="md-nav__link">
    PandasTaFeatureGenerator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rolling-your-own-preprocessor" class="md-nav__link">
    Rolling your own preprocessor
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../targets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Target Engineering
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../meta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meta Estimators
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../neutralization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Neutralization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../penalization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Penalization
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../prediction_loaders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction Loaders
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../evaluation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evaluation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../submission/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Submitters
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How To Contribute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../crowdcent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About CrowdCent
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../disclaimer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Disclaimer
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#numerai-classic" class="md-nav__link">
    Numerai Classic
  </a>
  
    <nav class="md-nav" aria-label="Numerai Classic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#groupstatspreprocessor" class="md-nav__link">
    GroupStatsPreProcessor
  </a>
  
    <nav class="md-nav" aria-label="GroupStatsPreProcessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numerai-signals" class="md-nav__link">
    Numerai Signals
  </a>
  
    <nav class="md-nav" aria-label="Numerai Signals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reducememoryprocessor" class="md-nav__link">
    ReduceMemoryProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#katsufeaturegenerator" class="md-nav__link">
    KatsuFeatureGenerator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#eraquantileprocessor" class="md-nav__link">
    EraQuantileProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tickermapper" class="md-nav__link">
    TickerMapper
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lagpreprocessor" class="md-nav__link">
    LagPreProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differencepreprocessor" class="md-nav__link">
    DifferencePreProcessor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pandastafeaturegenerator" class="md-nav__link">
    PandasTaFeatureGenerator
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rolling-your-own-preprocessor" class="md-nav__link">
    Rolling your own preprocessor
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="preprocessors">Preprocessors</h1>
<p>NumerBlox offers a suite of preprocessors to easily do Numerai specific data transformations. All preprocessors are compatible with <code>scikit-learn</code> pipelines and feature a similar API. Note that some preprocessors may require an additional <code>eras</code> or <code>tickers</code> argument in the <code>transform</code> step.</p>
<h2 id="numerai-classic">Numerai Classic</h2>
<h3 id="groupstatspreprocessor">GroupStatsPreProcessor</h3>
<p>The v4.2 (rain) dataset for Numerai Classic reintroduced feature groups. The <code>GroupStatsPreProcessor</code> calculates group statistics for all data groups. It uses predefined feature group mappings to generate statistical measures (mean, standard deviation, skew) for each of the feature groups. </p>
<h4 id="example">Example</h4>
<p>Here's how you can use the <code>GroupStatsPreProcessor</code>:</p>
<pre><code class="language-python">from numerblox.preprocessing import GroupStatsPreProcessor
group_processor = GroupStatsPreProcessor(groups=['intelligence'])

# Return features with group statistics for the 'intelligence' group
features = group_processor.transform(X)
</code></pre>
<h2 id="numerai-signals">Numerai Signals</h2>
<h3 id="reducememoryprocessor">ReduceMemoryProcessor</h3>
<p>The <code>ReduceMemoryProcessor</code> reduces the memory usage of the data as much as possible. It's particularly useful for Numerai Signals dataset which can be quite large.</p>
<p>Note that modern Numerai Classic Data (v4.2+) already is an int8 format so this processor will be not be useful for Numerai Classic.</p>
<pre><code class="language-py">from numerblox.preprocessing import ReduceMemoryProcessor

processor = ReduceMemoryProcessor(deep_mem_inspect=True, verbose=True)
reduced_data = processor.fit_transform(dataf)
</code></pre>
<h3 id="katsufeaturegenerator">KatsuFeatureGenerator</h3>
<p><code>KatsuFeatureGenerator</code> performs feature engineering based on <a href="https://www.kaggle.com/code1110/numeraisignals-starter-for-beginners">Katsu's starter notebook</a>. This is useful for those participating in the Numerai Signals contest.</p>
<p>You can specify custom windows that indicates how many days to look back when generating features.</p>
<pre><code class="language-py">from numerblox.preprocessing import KatsuFeatureGenerator

feature_gen = KatsuFeatureGenerator(windows=[7, 14, 21])
enhanced_data = feature_gen.fit_transform(dataf)
</code></pre>
<h3 id="eraquantileprocessor">EraQuantileProcessor</h3>
<p><code>EraQuantileProcessor</code> transforms features into quantiles by era. This can help normalize data and make patterns more distinguishable.</p>
<p>Using <code>.transform</code> requires passing the era column as a <code>pd.Series</code>. This is because the quantiles are calculated per era so it needs that information along with the raw input features.</p>
<pre><code class="language-py">from numerblox.preprocessing import EraQuantileProcessor

eq_processor = EraQuantileProcessor(num_quantiles=50, random_state=42)
transformed_data = eq_processor.fit_transform(X, eras=eras_series)
</code></pre>
<h3 id="tickermapper">TickerMapper</h3>
<p><code>TickerMapper</code> maps tickers from one format to another. Useful when working with data from multiple sources that have different ticker formats.</p>
<p>For the default ticker mapper the following formats are supported: <code>['ticker', 'bloomberg_ticker', 'yahoo']</code>. You can also specify a custom mapping by passing a dictionary to the <code>mapper_path</code> argument at the instantiation.</p>
<pre><code class="language-py">from numerblox.preprocessing import TickerMapper

# Transform from ticker to Bloomberg format.
ticker_mapper = TickerMapper(ticker_col=&quot;ticker&quot;, target_ticker_format=&quot;bloomberg_ticker&quot;)
mapped_data = ticker_mapper.transform(dataf[&quot;ticker&quot;])
</code></pre>
<h3 id="lagpreprocessor">LagPreProcessor</h3>
<p><code>LagPreProcessor</code> generates lag features based on specified windows. Lag features can capture temporal patterns in time-series data.</p>
<p>Note that <code>LagPreProcessor</code> needs a series of <code>tickers</code> in the <code>.transform</code> step.</p>
<pre><code class="language-py">from numerblox.preprocessing import LagPreProcessor

lag_processor = LagPreProcessor(windows=[5, 10, 20])
lag_processor.fit(X)
lagged_data = lag_processor.transform(X, tickers=tickers_series)

</code></pre>
<h3 id="differencepreprocessor">DifferencePreProcessor</h3>
<p><code>DifferencePreProcessor</code> computes the difference between features and their lags. It's used after <code>LagPreProcessor</code>.</p>
<p>WARNING: <code>DifferencePreProcessor</code> works only on <code>pd.DataFrame</code> and with columns that are generated in <code>LagPreProcessor</code>. If you are using these in a Pipeline make sure <code>LagPreProcessor</code> is defined before <code>DifferencePreProcessor</code> and that output API is set to Pandas (<code>pipeline.set_output(transform="pandas")</code>).</p>
<p>Note that <code>LagPreProcessor</code> needs a series of <code>tickers</code> in the <code>.transform</code> step so a pipeline with both preprocessors will need a <code>tickers</code> argument in <code>.transform</code>.</p>
<pre><code class="language-py">from sklearn.pipeline import make_pipeline
from numerblox.preprocessing import DifferencePreProcessor

lag = LagPreProcessor(windows=[5, 10])
diff = DifferencePreProcessor(windows=[5, 10], pct_diff=True)
pipe = make_pipeline(lag, diff)
pipe.set_output(transform=&quot;pandas&quot;)
pipe.fit(X)
diff_data = pipe.transform(X, tickers=tickers_series)
</code></pre>
<h3 id="pandastafeaturegenerator">PandasTaFeatureGenerator</h3>
<p><code>PandasTaFeatureGenerator</code> uses the <code>pandas-ta</code> library to generate technical analysis features. It's a powerful tool for those interested in financial time-series data.</p>
<p>Make sure you have <code>pandas-ta</code> installed before using this feature generator:</p>
<pre><code class="language-bash">!pip install pandas-ta
</code></pre>
<p>Currently <code>PandasTaFeatureGenerator</code> only works on <code>pd.DataFrame</code> input. Its input is a DataFrame with columns <code>[ticker, date, open, high, low, close, volume]</code>.</p>
<pre><code class="language-py">from numerblox.preprocessing import PandasTaFeatureGenerator

ta_gen = PandasTaFeatureGenerator()
ta_features = ta_gen.transform(dataf)
</code></pre>
<h2 id="rolling-your-own-preprocessor">Rolling your own preprocessor</h2>
<p>We invite the community to contribute their own preprocessors to NumerBlox. If you have a preprocessor that you think would be useful to others, please open a PR with your code and tests.
The new preprocessor should adhere to <a href="https://scikit-learn.org/stable/developers/develop.html">scikit-learn conventions</a>. Here are some the most important things to keep in mind and a template.</p>
<ul>
<li>Make sure that your preprocessor inherits from <code>numerblox.preprocessing.base.BasePreProcessor</code>. This will automatically implement a blank fit method. It will also inherit from <code>sklearn.base.TransformerMixin</code> and <code>sklearn.base.BaseEstimator</code>.</li>
<li>Make sure your preprocessor implements a <code>transform</code> method that can take a <code>np.array</code> or <code>pd.DataFrame</code> as input and outputs an <code>np.array</code>. If your preprocessor can only work with <code>pd.DataFrame</code> input, mention this explicitly in the docstring.</li>
<li>Implement a <code>get_feature_names_out</code> method so it can support <code>pd.DataFrame</code> output with valid column names.</li>
</ul>
<pre><code class="language-py">import numpy as np
import pandas as pd
from typing import Union
from sklearn.validation import check_is_fitted, check_X_y
from numerblox.preprocessing.base import BasePreProcessor

class MyAwesomePreProcessor(BasePreProcessor):
    def __init__(self, random_state: int = 0):
        super().__init__()
        # If you introduce additional arguments be sure to add them as attributes.
        self.random_state = random_state

    def fit(self, X: Union[np.array, pd.DataFrame], y=None):
        # Arguments can be set for later use.
        self.n_cols_ = X.shape[1]
        return self

    def transform(self, X: Union[np.array, pd.DataFrame]) -&gt; np.array:
        # Do your preprocessing here.
        # Can involve additional checks.
        check_is_fitted(self)
        X = check_X_y(X)
        return X

    def get_feature_names_out(self, input_features=None) -&gt; list:
        # Return a list of feature names.
        # If you are not using pandas output, you can skip this method.
        check_is_fitted(self)
        return [&quot;awesome_output_feature_{i}&quot; for i in range(self.n_cols_)]
</code></pre>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "navigation.tabs", "navigation.tracking", "navigation.tabs.sticky", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.81fa17fe.min.js"></script>
      
    
  </body>
</html>