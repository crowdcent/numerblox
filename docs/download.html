---

title: Download


keywords: fastai
sidebar: home_sidebar

summary: "Functionality to easily download data to your environment."
description: "Functionality to easily download data to your environment."
nb_path: "nbs/01_download.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_download.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="0.-BaseIO">0. BaseIO<a class="anchor-link" href="#0.-BaseIO"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are common methods needed for <code>Downloaders</code> and <code>Submittors</code>. <a href="/numerbloxdownload.html#BaseIO"><code>BaseIO</code></a> implements this functionality and allows us to make abstract base classes. Namely, <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a> and <a href="/numerbloxsubmission.html#BaseSubmitter"><code>BaseSubmitter</code></a> (implemented in <code>submission</code> section).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseIO" class="doc_header"><code>class</code> <code>BaseIO</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L35" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseIO</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <code>ABC</code></p>
</blockquote>
<p>Basic functionality for IO (downloading and uploading).</p>
<p>:param directory_path: Base folder for IO. Will be created if it does not exist.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="dcaa3786-dc03-4bbb-9cc9-3b332d5c6174" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#dcaa3786-dc03-4bbb-9cc9-3b332d5c6174');

            setTimeout(function() {
                var nbb_cell_id = 5;
                var nbb_unformatted_code = "# export\n@typechecked\nclass BaseIO(ABC):\n    \"\"\"\n    Basic functionality for IO (downloading and uploading).\n\n    :param directory_path: Base folder for IO. Will be created if it does not exist.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        self.dir = Path(directory_path)\n        self._create_directory()\n\n    def remove_base_directory(self):\n        \"\"\"Remove directory with all contents.\"\"\"\n        abs_path = self.dir.resolve()\n        rich_print(\n            f\":warning: [red]Deleting directory for '{self.__class__.__name__}[/red]' :warning:\\nPath: '{abs_path}'\"\n        )\n        shutil.rmtree(abs_path)\n\n    def download_file_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Get file from GCS bucket and download to local directory.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        blob.download_to_filename(gcs_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Downloaded GCS object '{gcs_path}' from bucket '{blob.bucket.id}' to local directory '{blob_path}'. :page_facing_up: :cloud:\"\n        )\n\n    def upload_file_to_gcs(self, bucket_name: str, gcs_path: str, local_path: str):\n        \"\"\"\n        Upload file to some GCS bucket.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Local file '{local_path}' uploaded to '{gcs_path}' in bucket {blob.bucket.id}:page_facing_up: :cloud:\"\n        )\n\n    def download_directory_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Copy full directory from GCS bucket to local environment.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        for gcs_file in glob.glob(gcs_path + \"/**\", recursive=True):\n            if os.path.isfile(gcs_file):\n                blob.download_to_filename(blob_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{gcs_path}' from bucket '{blob.bucket.id}' downloaded to '{blob_path}' :folder: :cloud:\"\n        )\n\n    def upload_directory_to_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Upload full base directory to GCS bucket.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        for local_path in glob.glob(str(self.dir) + \"/**\", recursive=True):\n            if os.path.isfile(local_path):\n                blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{self.dir}' uploaded to '{gcs_path}' in bucket {blob.bucket.id} :folder: :cloud:\"\n        )\n\n    def _get_gcs_blob(self, bucket_name: str, blob_path: str) -> storage.Blob:\n        \"\"\" Create blob that interacts with Google Cloud Storage (GCS). \"\"\"\n        client = storage.Client()\n        # https://console.cloud.google.com/storage/browser/[bucket_name]\n        bucket = client.get_bucket(bucket_name)\n        blob = bucket.blob(blob_path)\n        return blob\n\n    def _append_folder(self, folder: str) -> Path:\n        \"\"\"\n        Return base directory Path object appended with 'folder'.\n        Create directory if it does not exist.\n        \"\"\"\n        dir = Path(self.dir / folder)\n        dir.mkdir(parents=True, exist_ok=True)\n        return dir\n\n    def _create_directory(self):\n        \"\"\" Create base directory if it does not exist. \"\"\"\n        if not self.dir.is_dir():\n            rich_print(\n                f\"No existing directory found at '[blue]{self.dir}[/blue]'. Creating directory...\"\n            )\n            self.dir.mkdir(parents=True, exist_ok=True)\n\n    @property\n    def get_all_files(self) -> list:\n        \"\"\" Return all paths of contents in directory. \"\"\"\n        return list(self.dir.iterdir())\n\n    @property\n    def is_empty(self) -> bool:\n        \"\"\" Check if directory is empty. \"\"\"\n        return not bool(self.get_all_files)";
                var nbb_formatted_code = "# export\n@typechecked\nclass BaseIO(ABC):\n    \"\"\"\n    Basic functionality for IO (downloading and uploading).\n\n    :param directory_path: Base folder for IO. Will be created if it does not exist.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        self.dir = Path(directory_path)\n        self._create_directory()\n\n    def remove_base_directory(self):\n        \"\"\"Remove directory with all contents.\"\"\"\n        abs_path = self.dir.resolve()\n        rich_print(\n            f\":warning: [red]Deleting directory for '{self.__class__.__name__}[/red]' :warning:\\nPath: '{abs_path}'\"\n        )\n        shutil.rmtree(abs_path)\n\n    def download_file_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Get file from GCS bucket and download to local directory.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        blob.download_to_filename(gcs_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Downloaded GCS object '{gcs_path}' from bucket '{blob.bucket.id}' to local directory '{blob_path}'. :page_facing_up: :cloud:\"\n        )\n\n    def upload_file_to_gcs(self, bucket_name: str, gcs_path: str, local_path: str):\n        \"\"\"\n        Upload file to some GCS bucket.\n        :param gcs_path: Path to file on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :page_facing_up: Local file '{local_path}' uploaded to '{gcs_path}' in bucket {blob.bucket.id}:page_facing_up: :cloud:\"\n        )\n\n    def download_directory_from_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Copy full directory from GCS bucket to local environment.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob_path = str(self.dir.resolve())\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=blob_path)\n        for gcs_file in glob.glob(gcs_path + \"/**\", recursive=True):\n            if os.path.isfile(gcs_file):\n                blob.download_to_filename(blob_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{gcs_path}' from bucket '{blob.bucket.id}' downloaded to '{blob_path}' :folder: :cloud:\"\n        )\n\n    def upload_directory_to_gcs(self, bucket_name: str, gcs_path: str):\n        \"\"\"\n        Upload full base directory to GCS bucket.\n        :param gcs_path: Name of directory on GCS bucket.\n        \"\"\"\n        blob = self._get_gcs_blob(bucket_name=bucket_name, blob_path=gcs_path)\n        for local_path in glob.glob(str(self.dir) + \"/**\", recursive=True):\n            if os.path.isfile(local_path):\n                blob.upload_from_filename(local_path)\n        rich_print(\n            f\":cloud: :folder: Directory '{self.dir}' uploaded to '{gcs_path}' in bucket {blob.bucket.id} :folder: :cloud:\"\n        )\n\n    def _get_gcs_blob(self, bucket_name: str, blob_path: str) -> storage.Blob:\n        \"\"\"Create blob that interacts with Google Cloud Storage (GCS).\"\"\"\n        client = storage.Client()\n        # https://console.cloud.google.com/storage/browser/[bucket_name]\n        bucket = client.get_bucket(bucket_name)\n        blob = bucket.blob(blob_path)\n        return blob\n\n    def _append_folder(self, folder: str) -> Path:\n        \"\"\"\n        Return base directory Path object appended with 'folder'.\n        Create directory if it does not exist.\n        \"\"\"\n        dir = Path(self.dir / folder)\n        dir.mkdir(parents=True, exist_ok=True)\n        return dir\n\n    def _create_directory(self):\n        \"\"\"Create base directory if it does not exist.\"\"\"\n        if not self.dir.is_dir():\n            rich_print(\n                f\"No existing directory found at '[blue]{self.dir}[/blue]'. Creating directory...\"\n            )\n            self.dir.mkdir(parents=True, exist_ok=True)\n\n    @property\n    def get_all_files(self) -> list:\n        \"\"\"Return all paths of contents in directory.\"\"\"\n        return list(self.dir.iterdir())\n\n    @property\n    def is_empty(self) -> bool:\n        \"\"\"Check if directory is empty.\"\"\"\n        return not bool(self.get_all_files)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-BaseDownloader">1. BaseDownloader<a class="anchor-link" href="#1.-BaseDownloader"> </a></h2><p><a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a> is an object which implements logic common to all downloaders.</p>
<p>To implement a new Downloader, you should inherit from <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a> and be sure to implement at least methods for <code>.download_training_data</code> and <code>.download_inference_data</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseDownloader" class="doc_header"><code>class</code> <code>BaseDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L140" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerbloxdownload.html#BaseIO"><code>BaseIO</code></a></p>
</blockquote>
<p>Abstract base class for downloaders.</p>
<p>:param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="71f2ddd6-1f4f-4aa3-a008-d07c988d1c0d" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#71f2ddd6-1f4f-4aa3-a008-d07c988d1c0d');

            setTimeout(function() {
                var nbb_cell_id = 6;
                var nbb_unformatted_code = "# export\n@typechecked\nclass BaseDownloader(BaseIO):\n    \"\"\"\n    Abstract base class for downloaders.\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    @abstractmethod\n    def download_training_data(self, *args, **kwargs):\n        \"\"\" Download all necessary files needed for training. \"\"\"\n        ...\n\n    @abstractmethod\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\" Download minimal amount of files needed for weekly inference. \"\"\"\n        ...\n\n    @staticmethod\n    def _load_json(file_path: str, verbose=False, *args, **kwargs) -> dict:\n        \"\"\" Load JSON from file and return as dictionary. \"\"\"\n        with open(Path(file_path)) as json_file:\n            json_data = json.load(json_file, *args, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        return json_data\n\n    def __call__(self, *args, **kwargs):\n        \"\"\"\n        The most common use case will be to get weekly inference data. So calling the class itself returns inference data.\n        \"\"\"\n        self.download_inference_data(*args, **kwargs)";
                var nbb_formatted_code = "# export\n@typechecked\nclass BaseDownloader(BaseIO):\n    \"\"\"\n    Abstract base class for downloaders.\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    @abstractmethod\n    def download_training_data(self, *args, **kwargs):\n        \"\"\"Download all necessary files needed for training.\"\"\"\n        ...\n\n    @abstractmethod\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\"Download minimal amount of files needed for weekly inference.\"\"\"\n        ...\n\n    @staticmethod\n    def _load_json(file_path: str, verbose=False, *args, **kwargs) -> dict:\n        \"\"\"Load JSON from file and return as dictionary.\"\"\"\n        with open(Path(file_path)) as json_file:\n            json_data = json.load(json_file, *args, **kwargs)\n        if verbose:\n            rich_print(json_data)\n        return json_data\n\n    def __call__(self, *args, **kwargs):\n        \"\"\"\n        The most common use case will be to get weekly inference data. So calling the class itself returns inference data.\n        \"\"\"\n        self.download_inference_data(*args, **kwargs)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Numerai-Classic">2. Numerai Classic<a class="anchor-link" href="#2.-Numerai-Classic"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NumeraiClassicDownloader" class="doc_header"><code>class</code> <code>NumeraiClassicDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L175" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NumeraiClassicDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>, <strong>*<code>args</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>WARNING: Versions 1 and 2 (legacy data) are deprecated. Only supporting version 3+.</p>
<p>Downloading from NumerAPI for Numerai Classic data.</p>
<p>:param directory_path: Base folder to download files to.</p>
<p>All *args, **kwargs will be passed to NumerAPI initialization.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="2bd51901-07a1-4011-8807-63ccf05fc6f7" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#2bd51901-07a1-4011-8807-63ccf05fc6f7');

            setTimeout(function() {
                var nbb_cell_id = 7;
                var nbb_unformatted_code = "# export\nclass NumeraiClassicDownloader(BaseDownloader):\n    \"\"\"\n    WARNING: Versions 1 and 2 (legacy data) are deprecated. Only supporting version 3+.\n\n    Downloading from NumerAPI for Numerai Classic data. \\n\n    :param directory_path: Base folder to download files to. \\n\n    All *args, **kwargs will be passed to NumerAPI initialization.\n    \"\"\"\n    def __init__(self, directory_path: str, *args, **kwargs):\n        super().__init__(directory_path=directory_path)\n        self.napi = NumerAPI(*args, **kwargs)\n        self.current_round = self.napi.get_current_round()\n        # NumerAPI filenames corresponding to version, class and data type\n        self.version_mapping = {\"3\": {\n            \"train\": {\n                \"int8\": [\n                    \"v3/numerai_training_data_int8.parquet\",\n                    \"v3/numerai_validation_data_int8.parquet\"\n                ],\n                \"float\": [\n                    \"v3/numerai_training_data.parquet\",\n                    \"v3/numerai_validation_data.parquet\"\n                ]\n            },\n            \"inference\": {\n                \"int8\": [\"v3/numerai_tournament_data_int8.parquet\"],\n                \"float\": [\"v3/numerai_tournament_data.parquet\"]\n            },\n            \"live\": {\n                \"int8\": [\"v3/numerai_live_data_int8.parquet\"],\n                \"float\": [\"v3/numerai_live_data.parquet\"]\n            },\n            \"example\": [\n                \"v3/example_predictions.parquet\",\n                \"v3/example_validation_predictions.parquet\"\n            ]\n        },\n            \"4\": {\n                \"train\": {\n                    \"int8\": [\n                        \"v4/train_int8.parquet\",\n                        \"v4/validation_int8.parquet\"\n                    ],\n                    \"float\": [\n                        \"v4/train.parquet\",\n                        \"v4/validation.parquet\"\n                    ]\n                },\n                \"inference\": {\n                    \"int8\": [\"v4/live_int8.parquet\"],\n                    \"float\": [\"v4/live.parquet\"]\n                },\n                \"live\": {\n                    \"int8\": [\"v4/live_int8.parquet\"],\n                    \"float\": [\"v4/live.parquet\"]\n                },\n                \"example\": [\n                    \"v4/live_example_preds.parquet\",\n                    \"v4/validation_example_preds.parquet\"\n                ]\n            }\n        }\n\n    def download_training_data(\n        self, subfolder: str = \"\", version: int = 4, int8: bool = False\n    ):\n        \"\"\"\n        Get Numerai classic training and validation data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (3=1050+ features dataset (parquet))\n        :param int8: Integer version of data\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        train_val_files = self._get_version_mapping(version)[\"train\"][data_type]\n        for file in train_val_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file,\n                dest_path=dest_path\n            )\n\n    def download_inference_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 4,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Get Numerai classic inference (tournament) data.\n        If only minimal live data is needed, consider .download_live_data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        inference_files = self._get_version_mapping(version)[\"inference\"][data_type]\n        for file in inference_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file,\n                dest_path=dest_path,\n                round_num=round_num\n            )\n\n    def download_single_dataset(\n        self, filename: str, dest_path: str, round_num: int = None\n    ):\n        \"\"\"\n        Download one of the available datasets through NumerAPI.\n\n        :param filename: Name as listed in NumerAPI (Check NumerAPI().list_datasets() for full overview)\n        :param dest_path: Full path where file will be saved.\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        rich_print(\n            f\":file_folder: [green]Downloading[/green] '{filename}' :file_folder:\"\n        )\n        self.napi.download_dataset(\n            filename=filename,\n            dest_path=dest_path,\n            round_num=round_num\n        )\n\n    def download_live_data(\n            self,\n            subfolder: str = \"\",\n            version: int = 4,\n            int8: bool = False,\n            round_num: int = None\n    ):\n        \"\"\"\n        Download all live data in specified folder for given version (i.e. minimal data needed for inference).\n\n        :param subfolder: Specify folder to create folder within directory root.\n        Saves in directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        live_files = self._get_version_mapping(version)[\"live\"][data_type]\n        for file in live_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file,\n                dest_path=dest_path,\n                round_num=round_num\n            )\n\n    def download_example_data(\n        self, subfolder: str = \"\", version: int = 4, round_num: int = None\n    ):\n        \"\"\"\n        Download all example prediction data in specified folder for given version.\n\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        example_files = self._get_version_mapping(version)[\"example\"]\n        for file in example_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file,\n                dest_path=dest_path,\n                round_num=round_num\n            )\n\n    def get_classic_features(self, subfolder: str = \"\", filename=\"v4/features.json\", *args, **kwargs) -> dict:\n        \"\"\"\n        Download feature overview (stats and feature sets) through NumerAPI and load as dict.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param filename: name for feature overview.\n        Currently defined as 'features.json' in NumerAPI and used as default.\n        *args, **kwargs will be passed to the JSON loader.\n        \"\"\"\n        dest_path = self.__get_dest_path(subfolder, filename)\n        self.download_single_dataset(filename=filename,\n                                     dest_path=dest_path)\n        json_data = self._load_json(dest_path, *args, **kwargs)\n        return json_data\n\n    def _get_version_mapping(self, version: int) -> dict:\n        \"\"\" Check if data version is supported and return file mapping for version. \"\"\"\n        try:\n            mapping_dictionary = self.version_mapping[str(version)]\n        except KeyError:\n            raise NotImplementedError(\n                f\"Version '{version}' is not available. Available versions are {list(self.version_mapping.keys())}\"\n            )\n        return mapping_dictionary\n\n    def __get_dest_path(self, subfolder: str, filename: str) -> str:\n        \"\"\" Prepare destination path for downloading. \"\"\"\n        dir = self._append_folder(subfolder)\n        dest_path = str(dir.joinpath(filename.split(\"/\")[-1]))\n        return dest_path";
                var nbb_formatted_code = "# export\nclass NumeraiClassicDownloader(BaseDownloader):\n    \"\"\"\n    WARNING: Versions 1 and 2 (legacy data) are deprecated. Only supporting version 3+.\n\n    Downloading from NumerAPI for Numerai Classic data. \\n\n    :param directory_path: Base folder to download files to. \\n\n    All *args, **kwargs will be passed to NumerAPI initialization.\n    \"\"\"\n\n    def __init__(self, directory_path: str, *args, **kwargs):\n        super().__init__(directory_path=directory_path)\n        self.napi = NumerAPI(*args, **kwargs)\n        self.current_round = self.napi.get_current_round()\n        # NumerAPI filenames corresponding to version, class and data type\n        self.version_mapping = {\n            \"3\": {\n                \"train\": {\n                    \"int8\": [\n                        \"v3/numerai_training_data_int8.parquet\",\n                        \"v3/numerai_validation_data_int8.parquet\",\n                    ],\n                    \"float\": [\n                        \"v3/numerai_training_data.parquet\",\n                        \"v3/numerai_validation_data.parquet\",\n                    ],\n                },\n                \"inference\": {\n                    \"int8\": [\"v3/numerai_tournament_data_int8.parquet\"],\n                    \"float\": [\"v3/numerai_tournament_data.parquet\"],\n                },\n                \"live\": {\n                    \"int8\": [\"v3/numerai_live_data_int8.parquet\"],\n                    \"float\": [\"v3/numerai_live_data.parquet\"],\n                },\n                \"example\": [\n                    \"v3/example_predictions.parquet\",\n                    \"v3/example_validation_predictions.parquet\",\n                ],\n            },\n            \"4\": {\n                \"train\": {\n                    \"int8\": [\"v4/train_int8.parquet\", \"v4/validation_int8.parquet\"],\n                    \"float\": [\"v4/train.parquet\", \"v4/validation.parquet\"],\n                },\n                \"inference\": {\n                    \"int8\": [\"v4/live_int8.parquet\"],\n                    \"float\": [\"v4/live.parquet\"],\n                },\n                \"live\": {\n                    \"int8\": [\"v4/live_int8.parquet\"],\n                    \"float\": [\"v4/live.parquet\"],\n                },\n                \"example\": [\n                    \"v4/live_example_preds.parquet\",\n                    \"v4/validation_example_preds.parquet\",\n                ],\n            },\n        }\n\n    def download_training_data(\n        self, subfolder: str = \"\", version: int = 4, int8: bool = False\n    ):\n        \"\"\"\n        Get Numerai classic training and validation data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (3=1050+ features dataset (parquet))\n        :param int8: Integer version of data\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        train_val_files = self._get_version_mapping(version)[\"train\"][data_type]\n        for file in train_val_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(filename=file, dest_path=dest_path)\n\n    def download_inference_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 4,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Get Numerai classic inference (tournament) data.\n        If only minimal live data is needed, consider .download_live_data.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        inference_files = self._get_version_mapping(version)[\"inference\"][data_type]\n        for file in inference_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file, dest_path=dest_path, round_num=round_num\n            )\n\n    def download_single_dataset(\n        self, filename: str, dest_path: str, round_num: int = None\n    ):\n        \"\"\"\n        Download one of the available datasets through NumerAPI.\n\n        :param filename: Name as listed in NumerAPI (Check NumerAPI().list_datasets() for full overview)\n        :param dest_path: Full path where file will be saved.\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        rich_print(\n            f\":file_folder: [green]Downloading[/green] '{filename}' :file_folder:\"\n        )\n        self.napi.download_dataset(\n            filename=filename, dest_path=dest_path, round_num=round_num\n        )\n\n    def download_live_data(\n        self,\n        subfolder: str = \"\",\n        version: int = 4,\n        int8: bool = False,\n        round_num: int = None,\n    ):\n        \"\"\"\n        Download all live data in specified folder for given version (i.e. minimal data needed for inference).\n\n        :param subfolder: Specify folder to create folder within directory root.\n        Saves in directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param int8: Integer version of data\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        data_type = \"int8\" if int8 else \"float\"\n        live_files = self._get_version_mapping(version)[\"live\"][data_type]\n        for file in live_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file, dest_path=dest_path, round_num=round_num\n            )\n\n    def download_example_data(\n        self, subfolder: str = \"\", version: int = 4, round_num: int = None\n    ):\n        \"\"\"\n        Download all example prediction data in specified folder for given version.\n\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param version: Numerai dataset version (2=super massive dataset (parquet))\n        :param round_num: Numerai tournament round number. Downloads latest round by default.\n        \"\"\"\n        example_files = self._get_version_mapping(version)[\"example\"]\n        for file in example_files:\n            dest_path = self.__get_dest_path(subfolder, file)\n            self.download_single_dataset(\n                filename=file, dest_path=dest_path, round_num=round_num\n            )\n\n    def get_classic_features(\n        self, subfolder: str = \"\", filename=\"v4/features.json\", *args, **kwargs\n    ) -> dict:\n        \"\"\"\n        Download feature overview (stats and feature sets) through NumerAPI and load as dict.\n        :param subfolder: Specify folder to create folder within base directory root.\n        Saves in base directory root by default.\n        :param filename: name for feature overview.\n        Currently defined as 'features.json' in NumerAPI and used as default.\n        *args, **kwargs will be passed to the JSON loader.\n        \"\"\"\n        dest_path = self.__get_dest_path(subfolder, filename)\n        self.download_single_dataset(filename=filename, dest_path=dest_path)\n        json_data = self._load_json(dest_path, *args, **kwargs)\n        return json_data\n\n    def _get_version_mapping(self, version: int) -> dict:\n        \"\"\"Check if data version is supported and return file mapping for version.\"\"\"\n        try:\n            mapping_dictionary = self.version_mapping[str(version)]\n        except KeyError:\n            raise NotImplementedError(\n                f\"Version '{version}' is not available. Available versions are {list(self.version_mapping.keys())}\"\n            )\n        return mapping_dictionary\n\n    def __get_dest_path(self, subfolder: str, filename: str) -> str:\n        \"\"\"Prepare destination path for downloading.\"\"\"\n        dir = self._append_folder(subfolder)\n        dest_path = str(dir.joinpath(filename.split(\"/\")[-1]))\n        return dest_path";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.1.-Example-usage">2.1. Example usage<a class="anchor-link" href="#2.1.-Example-usage"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This section will explain how to quickly get started with <a href="/numerbloxdownload.html#NumeraiClassicDownloader"><code>NumeraiClassicDownloader</code></a>.</p>
<p>The more advanced use case of working with GCS (Google Cloud Storage) is discussed in <code>edu_nbs/google_cloud_storage.ipynb</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.1.1.-Training-data">2.1.1. Training data<a class="anchor-link" href="#2.1.1.-Training-data"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Training + validation data for Numerai Classic can be downloaded with effectively 2 lines of code.
Feature stats and overview can be downloaded with <code>.get_classic_features()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialization</span>
<span class="n">train_base_directory</span> <span class="o">=</span> <span class="s2">&quot;test_numclassic_train&quot;</span>
<span class="n">numer_classic_downloader</span> <span class="o">=</span> <span class="n">NumeraiClassicDownloader</span><span class="p">(</span><span class="n">train_base_directory</span><span class="p">)</span>

<span class="c1"># Uncomment line below to download training and validation data</span>
<span class="c1"># numer_classic_downloader.download_training_data(&quot;train_val&quot;, int8=False)</span>

<span class="c1"># Get feature overview (dict)</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">get_classic_features</span><span class="p">()</span>

<span class="c1"># Remove contents (To clean up environment)</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_numclassic_train</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üìÅ <span style="color: #008000; text-decoration-color: #008000">Downloading</span> <span style="color: #008000; text-decoration-color: #008000">'v4/features.json'</span> üìÅ
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-05-11 18:07:23,822 INFO numerapi.utils: starting download
test_numclassic_train/features.json: 562kB [00:00, 800kB/s]                             
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'NumeraiClassicDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ‚ö†
Path: 
<span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_numclassic_train'</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="854b1856-b106-4124-9263-d1ade2b7db75" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#854b1856-b106-4124-9263-d1ade2b7db75');

            setTimeout(function() {
                var nbb_cell_id = 9;
                var nbb_unformatted_code = "# slow\n# Initialization\ntrain_base_directory = \"test_numclassic_train\"\nnumer_classic_downloader = NumeraiClassicDownloader(train_base_directory)\n\n# Uncomment line below to download training and validation data\n# numer_classic_downloader.download_training_data(\"train_val\", int8=False)\n\n# Get feature overview (dict)\nnumer_classic_downloader.get_classic_features()\n\n# Remove contents (To clean up environment)\nnumer_classic_downloader.remove_base_directory()";
                var nbb_formatted_code = "# slow\n# Initialization\ntrain_base_directory = \"test_numclassic_train\"\nnumer_classic_downloader = NumeraiClassicDownloader(train_base_directory)\n\n# Uncomment line below to download training and validation data\n# numer_classic_downloader.download_training_data(\"train_val\", int8=False)\n\n# Get feature overview (dict)\nnumer_classic_downloader.get_classic_features()\n\n# Remove contents (To clean up environment)\nnumer_classic_downloader.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>For the training example the directory structure will be:</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üìÅ test_numclassic_train (base_directory)                                                           
<span style="color: #808080; text-decoration-color: #808080">‚î£‚îÅ‚îÅ </span>üìÑ features.json                                                                                
<span style="color: #808080; text-decoration-color: #808080">‚îó‚îÅ‚îÅ </span>üìÅ train_val                                                                                    
<span style="color: #808080; text-decoration-color: #808080">    ‚î£‚îÅ‚îÅ </span>üìÑ numerai_training_data.parquet                                                            
<span style="color: #808080; text-decoration-color: #808080">    ‚îó‚îÅ‚îÅ </span>üìÑ numerai_validation_data.parquet                                                          
</pre>
</div>

</div>

<div class="output_area">




<div id="7eab9e16-e6dc-4ab6-bbe9-161688beb41b" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#7eab9e16-e6dc-4ab6-bbe9-161688beb41b');

            setTimeout(function() {
                var nbb_cell_id = 10;
                var nbb_unformatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {train_base_directory} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\nfolder_tree = tree.add(\":page_facing_up: features.json\")\ntrain_val_tree = tree.add(\":file_folder: train_val\")\ntrain_val_tree.add(\":page_facing_up: numerai_training_data.parquet\")\ntrain_val_tree.add(\":page_facing_up: numerai_validation_data.parquet\")\n\nconsole.print(tree)";
                var nbb_formatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {train_base_directory} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\nfolder_tree = tree.add(\":page_facing_up: features.json\")\ntrain_val_tree = tree.add(\":file_folder: train_val\")\ntrain_val_tree.add(\":page_facing_up: numerai_training_data.parquet\")\ntrain_val_tree.add(\":page_facing_up: numerai_validation_data.parquet\")\n\nconsole.print(tree)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="2.1.2.-Inference-data">2.1.2. Inference data<a class="anchor-link" href="#2.1.2.-Inference-data"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inference data for the most recent round of Numerai Classic can be downloaded with effectively 2 lines of code.
It can also easily be deleted after you are done with inference by calling <code>.remove_base_directory</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initialization</span>
<span class="n">inference_base_dir</span> <span class="o">=</span> <span class="s2">&quot;test_numclassic_inference&quot;</span>
<span class="n">numer_classic_downloader</span> <span class="o">=</span> <span class="n">NumeraiClassicDownloader</span><span class="p">(</span><span class="n">directory_path</span><span class="o">=</span><span class="n">inference_base_dir</span><span class="p">)</span>

<span class="c1"># Download tournament (inference) data</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">download_inference_data</span><span class="p">(</span><span class="s2">&quot;inference&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">int8</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Remove folder when done with inference</span>
<span class="n">numer_classic_downloader</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_numclassic_inference</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üìÅ <span style="color: #008000; text-decoration-color: #008000">Downloading</span> <span style="color: #008000; text-decoration-color: #008000">'v4/live_int8.parquet'</span> üìÅ
</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-05-11 18:07:26,979 INFO numerapi.utils: starting download
test_numclassic_inference/inference/live_int8.parquet: 3.54MB [00:01, 2.16MB/s]                            
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'NumeraiClassicDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ‚ö†
Path: <span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_numclassic_in</span>
<span style="color: #008000; text-decoration-color: #008000">ference'</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="5435f386-c1d0-48b2-bf92-a034281f3e6d" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#5435f386-c1d0-48b2-bf92-a034281f3e6d');

            setTimeout(function() {
                var nbb_cell_id = 11;
                var nbb_unformatted_code = "# slow\n# Initialization\ninference_base_dir = \"test_numclassic_inference\"\nnumer_classic_downloader = NumeraiClassicDownloader(directory_path=inference_base_dir)\n\n# Download tournament (inference) data\nnumer_classic_downloader.download_inference_data(\"inference\", version=4, int8=True)\n\n# Remove folder when done with inference\nnumer_classic_downloader.remove_base_directory()";
                var nbb_formatted_code = "# slow\n# Initialization\ninference_base_dir = \"test_numclassic_inference\"\nnumer_classic_downloader = NumeraiClassicDownloader(directory_path=inference_base_dir)\n\n# Download tournament (inference) data\nnumer_classic_downloader.download_inference_data(\"inference\", version=4, int8=True)\n\n# Remove folder when done with inference\nnumer_classic_downloader.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>For the inference example the directory structure will be:</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üìÅ test_numclassic_inference (base_directory)                                                       
<span style="color: #808080; text-decoration-color: #808080">‚îó‚îÅ‚îÅ </span>üìÅ inference                                                                                    
<span style="color: #808080; text-decoration-color: #808080">    ‚îó‚îÅ‚îÅ </span>üìÑ numerai_tournament_data.parquet                                                          
</pre>
</div>

</div>

<div class="output_area">




<div id="6bef117f-8d8f-44a7-a6b0-53dfe1f3fc07" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#6bef117f-8d8f-44a7-a6b0-53dfe1f3fc07');

            setTimeout(function() {
                var nbb_cell_id = 12;
                var nbb_unformatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {inference_base_dir} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\ninference_tree = tree.add(\":file_folder: inference\")\ninference_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\n\nconsole.print(tree)";
                var nbb_formatted_code = "# hide_input\nconsole = Console(record=True, width=100)\n\ntree = Tree(\n    f\":file_folder: {inference_base_dir} (base_directory)\",\n    guide_style=\"bold bright_black\",\n)\ninference_tree = tree.add(\":file_folder: inference\")\ninference_tree.add(\":page_facing_up: numerai_tournament_data.parquet\")\n\nconsole.print(tree)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-KaggleDownloader-(Numerai-Signals)">3. KaggleDownloader (Numerai Signals)<a class="anchor-link" href="#3.-KaggleDownloader-(Numerai-Signals)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Numerai community maintains some excellent datasets on Kaggle for Numerai Signals.</p>
<p>For example, <a href="https://www.kaggle.com/code1110">Katsu1110</a> maintains a <a href="https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals">dataset with yfinance price data</a> on Kaggle that is updated daily. <a href="/numerbloxdownload.html#KaggleDownloader"><code>KaggleDownloader</code></a> allows you to easily pull data through the Kaggle API. We will be using this dataset in an example below.</p>
<p>In this case, <code>download_inference_data</code> and <code>download_training_data</code> have the same functionality as we can't make the distinction beforehand for an arbitrary dataset on Kaggle.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="KaggleDownloader" class="doc_header"><code>class</code> <code>KaggleDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L380" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>KaggleDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>Download awesome financial data from Kaggle.</p>
<p>For authentication, make sure you have a directory called .kaggle in your home directory
with therein a kaggle.json file. kaggle.json should have the following structure:</p>
<p><code>{"username": USERNAME, "key": KAGGLE_API_KEY}</code></p>
<p>More info on authentication: github.com/Kaggle/kaggle-api#api-credentials</p>
<p>More info on the Kaggle Python API: kaggle.com/donkeys/kaggle-python-api</p>
<p>:param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="e2d1bead-720a-4a99-a14e-d83e8086b7ac" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e2d1bead-720a-4a99-a14e-d83e8086b7ac');

            setTimeout(function() {
                var nbb_cell_id = 13;
                var nbb_unformatted_code = "# export\nclass KaggleDownloader(BaseDownloader):\n    \"\"\"\n    Download awesome financial data from Kaggle.\n\n    For authentication, make sure you have a directory called .kaggle in your home directory\n    with therein a kaggle.json file. kaggle.json should have the following structure: \\n\n    `{\"username\": USERNAME, \"key\": KAGGLE_API_KEY}` \\n\n    More info on authentication: github.com/Kaggle/kaggle-api#api-credentials \\n\n\n    More info on the Kaggle Python API: kaggle.com/donkeys/kaggle-python-api \\n\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        self.__check_kaggle_import()\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        self.download_training_data(kaggle_dataset_path)\n\n    def download_training_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        import kaggle\n        kaggle.api.dataset_download_files(kaggle_dataset_path,\n                                          path=self.dir, unzip=True)\n\n    @staticmethod\n    def __check_kaggle_import():\n        try:\n            import kaggle\n        except OSError:\n            raise OSError(\"Could not find kaggle.json credentials. Make sure it's located in /home/runner/.kaggle. Or use the environment method. Check github.com/Kaggle/kaggle-api#api-credentials for more information on authentication.\")";
                var nbb_formatted_code = "# export\nclass KaggleDownloader(BaseDownloader):\n    \"\"\"\n    Download awesome financial data from Kaggle.\n\n    For authentication, make sure you have a directory called .kaggle in your home directory\n    with therein a kaggle.json file. kaggle.json should have the following structure: \\n\n    `{\"username\": USERNAME, \"key\": KAGGLE_API_KEY}` \\n\n    More info on authentication: github.com/Kaggle/kaggle-api#api-credentials \\n\n\n    More info on the Kaggle Python API: kaggle.com/donkeys/kaggle-python-api \\n\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        self.__check_kaggle_import()\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        self.download_training_data(kaggle_dataset_path)\n\n    def download_training_data(self, kaggle_dataset_path: str):\n        \"\"\"\n        Download arbitrary Kaggle dataset.\n        :param kaggle_dataset_path: Path on Kaggle (URL slug on kaggle.com/)\n        \"\"\"\n        import kaggle\n\n        kaggle.api.dataset_download_files(\n            kaggle_dataset_path, path=self.dir, unzip=True\n        )\n\n    @staticmethod\n    def __check_kaggle_import():\n        try:\n            import kaggle\n        except OSError:\n            raise OSError(\n                \"Could not find kaggle.json credentials. Make sure it's located in /home/runner/.kaggle. Or use the environment method. Check github.com/Kaggle/kaggle-api#api-credentials for more information on authentication.\"\n            )";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The link to Katsu1110's yfinance price dataset is <a href="https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals">https://www.kaggle.com/code1110/yfinance-stock-price-data-for-numerai-signals</a>. In <code>.download_training_data</code> we define the slug after kaggle.com (<code>code1110/yfinance-stock-price-data-for-numerai-signals</code>) as an argument. The full Kaggle dataset is downloaded and unzipped.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">home_directory</span> <span class="o">=</span> <span class="s2">&quot;test_kaggle_downloader&quot;</span>
<span class="n">kd</span> <span class="o">=</span> <span class="n">KaggleDownloader</span><span class="p">(</span><span class="n">home_directory</span><span class="p">)</span>
<span class="n">kd</span><span class="o">.</span><span class="n">download_training_data</span><span class="p">(</span><span class="s2">&quot;code1110/yfinance-stock-price-data-for-numerai-signals&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">test_kaggle_downloader</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="cea64241-d1fd-4769-b15b-9c3e99188ce3" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#cea64241-d1fd-4769-b15b-9c3e99188ce3');

            setTimeout(function() {
                var nbb_cell_id = 14;
                var nbb_unformatted_code = "# other\nhome_directory = \"test_kaggle_downloader\"\nkd = KaggleDownloader(home_directory)\nkd.download_training_data(\"code1110/yfinance-stock-price-data-for-numerai-signals\")";
                var nbb_formatted_code = "# other\nhome_directory = \"test_kaggle_downloader\"\nkd = KaggleDownloader(home_directory)\nkd.download_training_data(\"code1110/yfinance-stock-price-data-for-numerai-signals\")";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This Kaggle dataset contains one file called <code>"full_data.parquet"</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">kd</span><span class="o">.</span><span class="n">dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Path(&#39;test_kaggle_downloader/full_data.parquet&#39;)]</pre>
</div>

</div>

<div class="output_area">




<div id="787e9dcc-9f3c-4204-abf9-138f79039e6b" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#787e9dcc-9f3c-4204-abf9-138f79039e6b');

            setTimeout(function() {
                var nbb_cell_id = 15;
                var nbb_unformatted_code = "# other\nlist(kd.dir.iterdir())";
                var nbb_formatted_code = "# other\nlist(kd.dir.iterdir())";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">home_directory</span><span class="si">}</span><span class="s2">/full_data.parquet&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ticker</th>
      <th>date</th>
      <th>close</th>
      <th>raw_close</th>
      <th>high</th>
      <th>low</th>
      <th>open</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>000060 KS</td>
      <td>20020103</td>
      <td>534.924255</td>
      <td>1248.795166</td>
      <td>1248.795166</td>
      <td>1248.795166</td>
      <td>1248.795166</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000060 KS</td>
      <td>20020104</td>
      <td>566.944397</td>
      <td>1323.546997</td>
      <td>1363.121460</td>
      <td>1213.617798</td>
      <td>1275.178223</td>
      <td>3937763.0</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

<div class="output_area">




<div id="739f6807-9172-4230-aad9-dda81f4e060d" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#739f6807-9172-4230-aad9-dda81f4e060d');

            setTimeout(function() {
                var nbb_cell_id = 16;
                var nbb_unformatted_code = "# other\ndf = pd.read_parquet(f\"{home_directory}/full_data.parquet\")\ndf.head(2)";
                var nbb_formatted_code = "# other\ndf = pd.read_parquet(f\"{home_directory}/full_data.parquet\")\ndf.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Folder can be cleaned up when done with inference.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kd</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'KaggleDownloader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ‚ö†
Path: 
<span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/test_kaggle_downloader'</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="364aee09-11bd-4577-a4c4-549c8ab685a2" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#364aee09-11bd-4577-a4c4-549c8ab685a2');

            setTimeout(function() {
                var nbb_cell_id = 17;
                var nbb_unformatted_code = "# other\nkd.remove_base_directory()";
                var nbb_formatted_code = "# other\nkd.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Pandas-Datareader">4. Pandas Datareader<a class="anchor-link" href="#4.-Pandas-Datareader"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://pydata.github.io/pandas-datareader/stable/readers/index.html">pandas-datareader</a> is a library maintained by pydata. It offers several backends to directly retrieve data, including <a href="https://finance.yahoo.com/">Yahoo! Finance</a> and <a href="https://fred.stlouisfed.org/">FRED database</a>. Our <a href="/numerbloxdownload.html#PandasDataReader"><code>PandasDataReader</code></a> object simplifies pulling training, inference and live data for Numerai Signals pipelines.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PandasDataReader" class="doc_header"><code>class</code> <code>PandasDataReader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L421" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PandasDataReader</code>(<strong><code>directory_path</code></strong>:<code>str</code>, <strong><code>tickers</code></strong>:<code>list</code>, <strong><code>backend</code></strong>:<code>str</code>=<em><code>'yahoo'</code></em>) :: <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>Download financial data using Pandas Datareader.</p>
<p>:param directory_path: Base folder to download files to.</p>
<p>:param tickers: list of tickers used for downloading.</p>
<p>:param backend: Data provider you want to use. Yahoo Finance by default.</p>
<p>Check pydata.github.io/pandas-datareader/stable/readers/index.html to see all data readers.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="65c04a5e-92d0-4996-b2e7-963338b2c9ea" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#65c04a5e-92d0-4996-b2e7-963338b2c9ea');

            setTimeout(function() {
                var nbb_cell_id = 18;
                var nbb_unformatted_code = "# export\nclass PandasDataReader(BaseDownloader):\n    \"\"\"\n    Download financial data using Pandas Datareader.\n\n    :param directory_path: Base folder to download files to. \\n\n    :param tickers: list of tickers used for downloading. \\n\n    :param backend: Data provider you want to use. Yahoo Finance by default. \\n\n    Check pydata.github.io/pandas-datareader/stable/readers/index.html to see all data readers.\n    \"\"\"\n    def __init__(self, directory_path: str, tickers: list, backend: str = 'yahoo'):\n        super().__init__(directory_path=directory_path)\n        self.tickers = tickers\n        self.backend = backend\n        self.current_time = dt.now()\n\n    def download_inference_data(self, save_path: str = None, *args, **kwargs):\n        \"\"\" Download a year of data. \"\"\"\n        start = self.current_time - relativedelta(years=1)\n        dataf = self._get_all_ticker_data(start=start, *args, **kwargs)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf.to_parquet(save_path)\n\n    def download_training_data(self, start: dt, save_path: str = None, *args, **kwargs):\n        \"\"\"\n        Download full training dataset with given start_date.\n        :param start: datetime object defining starting date.\n        :param save_path: Path for Parquet file.\n        \"\"\"\n        dataf = self._get_all_ticker_data(start=start, *args, **kwargs)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf.to_parquet(save_path)\n\n    def download_live_data(self, save_path: str = None, *args, **kwargs):\n        \"\"\" Download a month of data. \"\"\"\n        start = self.current_time - relativedelta(months=1)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf = self.get_live_data(*args, **kwargs)\n        dataf.to_parquet(save_path)\n\n    def get_live_data(self, *args, **kwargs) -> NumerFrame:\n        \"\"\" Get a month of data as DataFrame. \"\"\"\n        start = self.current_time - relativedelta(months=1)\n        return NumerFrame(self._get_all_ticker_data(start=start, *args, **kwargs))\n\n    def _get_all_ticker_data(self, start: dt, *args, **kwargs) -> pd.DataFrame:\n        \"\"\"\n        Get data for all tickers defined in class using given starting date.\n        :param start: datetime object defining starting date.\n        \"\"\"\n        func = partial(self.__get_ticker_data, start=start)\n        results = []\n        for tick in tqdm(self.tickers):\n            try:\n                res = func(ticker=tick, *args, **kwargs)\n            except RemoteDataError:\n                rich_print(f\":warning: WARNING: No data found for ticker: [red]'{tick}'[/red]. :warning:\")\n                continue\n            results.append(res)\n        dataf = pd.concat(results)\n        return dataf\n\n    def __get_ticker_data(self, ticker: str, start: dt, *args, **kwargs) -> pd.DataFrame:\n        dataf = web.DataReader(ticker, self.backend, start, self.current_time, *args, **kwargs)\n        dataf['ticker'] = ticker\n        dataf.index.names = ['date']\n        dataf = dataf.reset_index(drop=False)\n        return dataf\n\n    def __format_default_save_path(self, start: dt):\n        return f\"{self.dir}/{self.backend}_{start.strftime('%Y%m%d')}_{self.current_time.strftime('%Y%m%d')}.parquet\"";
                var nbb_formatted_code = "# export\nclass PandasDataReader(BaseDownloader):\n    \"\"\"\n    Download financial data using Pandas Datareader.\n\n    :param directory_path: Base folder to download files to. \\n\n    :param tickers: list of tickers used for downloading. \\n\n    :param backend: Data provider you want to use. Yahoo Finance by default. \\n\n    Check pydata.github.io/pandas-datareader/stable/readers/index.html to see all data readers.\n    \"\"\"\n\n    def __init__(self, directory_path: str, tickers: list, backend: str = \"yahoo\"):\n        super().__init__(directory_path=directory_path)\n        self.tickers = tickers\n        self.backend = backend\n        self.current_time = dt.now()\n\n    def download_inference_data(self, save_path: str = None, *args, **kwargs):\n        \"\"\"Download a year of data.\"\"\"\n        start = self.current_time - relativedelta(years=1)\n        dataf = self._get_all_ticker_data(start=start, *args, **kwargs)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf.to_parquet(save_path)\n\n    def download_training_data(self, start: dt, save_path: str = None, *args, **kwargs):\n        \"\"\"\n        Download full training dataset with given start_date.\n        :param start: datetime object defining starting date.\n        :param save_path: Path for Parquet file.\n        \"\"\"\n        dataf = self._get_all_ticker_data(start=start, *args, **kwargs)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf.to_parquet(save_path)\n\n    def download_live_data(self, save_path: str = None, *args, **kwargs):\n        \"\"\"Download a month of data.\"\"\"\n        start = self.current_time - relativedelta(months=1)\n        save_path = save_path if save_path else self.__format_default_save_path(start)\n        dataf = self.get_live_data(*args, **kwargs)\n        dataf.to_parquet(save_path)\n\n    def get_live_data(self, *args, **kwargs) -> NumerFrame:\n        \"\"\"Get a month of data as DataFrame.\"\"\"\n        start = self.current_time - relativedelta(months=1)\n        return NumerFrame(self._get_all_ticker_data(start=start, *args, **kwargs))\n\n    def _get_all_ticker_data(self, start: dt, *args, **kwargs) -> pd.DataFrame:\n        \"\"\"\n        Get data for all tickers defined in class using given starting date.\n        :param start: datetime object defining starting date.\n        \"\"\"\n        func = partial(self.__get_ticker_data, start=start)\n        results = []\n        for tick in tqdm(self.tickers):\n            try:\n                res = func(ticker=tick, *args, **kwargs)\n            except RemoteDataError:\n                rich_print(\n                    f\":warning: WARNING: No data found for ticker: [red]'{tick}'[/red]. :warning:\"\n                )\n                continue\n            results.append(res)\n        dataf = pd.concat(results)\n        return dataf\n\n    def __get_ticker_data(\n        self, ticker: str, start: dt, *args, **kwargs\n    ) -> pd.DataFrame:\n        dataf = web.DataReader(\n            ticker, self.backend, start, self.current_time, *args, **kwargs\n        )\n        dataf[\"ticker\"] = ticker\n        dataf.index.names = [\"date\"]\n        dataf = dataf.reset_index(drop=False)\n        return dataf\n\n    def __format_default_save_path(self, start: dt):\n        return f\"{self.dir}/{self.backend}_{start.strftime('%Y%m%d')}_{self.current_time.strftime('%Y%m%d')}.parquet\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdr</span> <span class="o">=</span> <span class="n">PandasDataReader</span><span class="p">(</span><span class="n">directory_path</span><span class="o">=</span><span class="s2">&quot;pandas_datareader_test&quot;</span><span class="p">,</span> <span class="n">tickers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;NOTATICKER&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">No existing directory found at <span style="color: #008000; text-decoration-color: #008000">'</span><span style="color: #000080; text-decoration-color: #000080">pandas_datareader_test</span><span style="color: #008000; text-decoration-color: #008000">'</span>. Creating directory<span style="color: #808000; text-decoration-color: #808000">...</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="a60d45db-ca61-4b41-bc40-637f97718794" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#a60d45db-ca61-4b41-bc40-637f97718794');

            setTimeout(function() {
                var nbb_cell_id = 19;
                var nbb_unformatted_code = "pdr = PandasDataReader(directory_path=\"pandas_datareader_test\", tickers=['AAPL', 'MSFT', 'NOTATICKER'])";
                var nbb_formatted_code = "pdr = PandasDataReader(\n    directory_path=\"pandas_datareader_test\", tickers=[\"AAPL\", \"MSFT\", \"NOTATICKER\"]\n)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.download_training_data</code> downloads all data from given start date (<code>datetime</code> object).</p>
<p><code>.download_inference_data</code> downloads data for a year.</p>
<p><code>.download_live_data</code> downloads data for a month.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdr</span><span class="o">.</span><span class="n">download_training_data</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">dt</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2008</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pdr</span><span class="o">.</span><span class="n">download_inference_data</span><span class="p">()</span>
<span class="n">pdr</span><span class="o">.</span><span class="n">download_live_data</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">Path</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pandas_datareader_test/yahoo_20080101_</span><span class="si">{</span><span class="n">dt</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2022-05-11 18:08:21,118 INFO numexpr.utils: Note: NumExpr detected 16 cores but &#34;NUMEXPR_MAX_THREADS&#34; not set, so enforcing safe limit of 8.
2022-05-11 18:08:21,119 INFO numexpr.utils: NumExpr defaulting to 8 threads.
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† WARNING: No data found for ticker: <span style="color: #800000; text-decoration-color: #800000">'NOTATICKER'</span>. ‚ö†
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† WARNING: No data found for ticker: <span style="color: #800000; text-decoration-color: #800000">'NOTATICKER'</span>. ‚ö†
</pre>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† WARNING: No data found for ticker: <span style="color: #800000; text-decoration-color: #800000">'NOTATICKER'</span>. ‚ö†
</pre>
</div>

</div>

<div class="output_area">




<div id="95ba5316-2405-46d3-8bec-465aaab19e1c" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#95ba5316-2405-46d3-8bec-465aaab19e1c');

            setTimeout(function() {
                var nbb_cell_id = 20;
                var nbb_unformatted_code = "pdr.download_training_data(start=dt(year=2008, month=1, day=1))\npdr.download_inference_data()\npdr.download_live_data()\n\nassert Path(f\"pandas_datareader_test/yahoo_20080101_{dt.now().strftime('%Y%m%d')}.parquet\").is_file()";
                var nbb_formatted_code = "pdr.download_training_data(start=dt(year=2008, month=1, day=1))\npdr.download_inference_data()\npdr.download_live_data()\n\nassert Path(\n    f\"pandas_datareader_test/yahoo_20080101_{dt.now().strftime('%Y%m%d')}.parquet\"\n).is_file()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.get_live_data()</code> returns a <a href="/numerbloxnumerframe.html#NumerFrame"><code>NumerFrame</code></a> directly with data for a month.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span> <span class="o">=</span> <span class="n">pdr</span><span class="o">.</span><span class="n">get_live_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† WARNING: No data found for ticker: <span style="color: #800000; text-decoration-color: #800000">'NOTATICKER'</span>. ‚ö†
</pre>
</div>

</div>

<div class="output_area">




<div id="20aac6c7-37ac-4159-832e-b50eda1a3b8f" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#20aac6c7-37ac-4159-832e-b50eda1a3b8f');

            setTimeout(function() {
                var nbb_cell_id = 21;
                var nbb_unformatted_code = "dataf = pdr.get_live_data()";
                var nbb_formatted_code = "dataf = pdr.get_live_data()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dataf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">dataf</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(44, 8)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>High</th>
      <th>Low</th>
      <th>Open</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Adj Close</th>
      <th>ticker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2022-04-11</td>
      <td>169.029999</td>
      <td>165.500000</td>
      <td>168.710007</td>
      <td>165.750000</td>
      <td>72246700.0</td>
      <td>165.506821</td>
      <td>AAPL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2022-04-12</td>
      <td>169.869995</td>
      <td>166.639999</td>
      <td>168.020004</td>
      <td>167.660004</td>
      <td>79265200.0</td>
      <td>167.414032</td>
      <td>AAPL</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

<div class="output_area">




<div id="b3efc924-2659-46f5-a5e0-5bd032f9f949" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#b3efc924-2659-46f5-a5e0-5bd032f9f949');

            setTimeout(function() {
                var nbb_cell_id = 22;
                var nbb_unformatted_code = "print(dataf.shape)\ndataf.head(2)";
                var nbb_formatted_code = "print(dataf.shape)\ndataf.head(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>High</th>
      <th>Low</th>
      <th>Open</th>
      <th>Close</th>
      <th>Volume</th>
      <th>Adj Close</th>
      <th>ticker</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20</th>
      <td>2022-05-10</td>
      <td>273.750000</td>
      <td>265.070007</td>
      <td>271.690002</td>
      <td>269.50000</td>
      <td>39292300.0</td>
      <td>269.50000</td>
      <td>MSFT</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2022-05-11</td>
      <td>271.359985</td>
      <td>263.779999</td>
      <td>265.679993</td>
      <td>265.23999</td>
      <td>16032857.0</td>
      <td>265.23999</td>
      <td>MSFT</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

<div class="output_area">




<div id="e578c6ef-7580-4805-95cf-6cbb095195a6" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#e578c6ef-7580-4805-95cf-6cbb095195a6');

            setTimeout(function() {
                var nbb_cell_id = 23;
                var nbb_unformatted_code = "dataf.tail(2)";
                var nbb_formatted_code = "dataf.tail(2)";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataf</span><span class="p">[</span><span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;AAPL&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">dataf</span><span class="p">[</span><span class="n">dataf</span><span class="p">[</span><span class="s1">&#39;ticker&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;MSFT&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">]);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">




<div id="d9c762f3-76c6-4a05-9611-6294d57b4384" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#d9c762f3-76c6-4a05-9611-6294d57b4384');

            setTimeout(function() {
                var nbb_cell_id = 24;
                var nbb_unformatted_code = "dataf[dataf['ticker']==\"AAPL\"].set_index(\"date\")['Adj Close'].plot()\ndataf[dataf['ticker']==\"MSFT\"].set_index(\"date\")['Adj Close'].plot()\nplt.legend(['AAPL', 'MSFT']);";
                var nbb_formatted_code = "dataf[dataf[\"ticker\"] == \"AAPL\"].set_index(\"date\")[\"Adj Close\"].plot()\ndataf[dataf[\"ticker\"] == \"MSFT\"].set_index(\"date\")[\"Adj Close\"].plot()\nplt.legend([\"AAPL\", \"MSFT\"])";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pdr</span><span class="o">.</span><span class="n">remove_base_directory</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea "><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">‚ö† <span style="color: #800000; text-decoration-color: #800000">Deleting directory for </span><span style="color: #800000; text-decoration-color: #800000">'PandasDataReader</span><span style="color: #008000; text-decoration-color: #008000">'</span> ‚ö†
Path: 
<span style="color: #008000; text-decoration-color: #008000">'/Users/clepelaars/Desktop/crowdcent/repositories/numerai-blocks/nbs/pandas_datareader_test'</span>
</pre>
</div>

</div>

<div class="output_area">




<div id="8764abc5-8402-4807-8d8a-5cefa03c0f1b" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#8764abc5-8402-4807-8d8a-5cefa03c0f1b');

            setTimeout(function() {
                var nbb_cell_id = 25;
                var nbb_unformatted_code = "pdr.remove_base_directory()";
                var nbb_formatted_code = "pdr.remove_base_directory()";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5.-FinnhubDownloader">5. FinnhubDownloader<a class="anchor-link" href="#5.-FinnhubDownloader"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FinnhubDownloader" class="doc_header"><code>class</code> <code>FinnhubDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L493" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FinnhubDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>, <strong><code>key</code></strong>:<code>str</code>, <strong><code>tickers</code></strong>:<code>list</code>, <strong><code>frequency</code></strong>:<code>str</code>=<em><code>'D'</code></em>) :: <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>Download financial data from Finnhub.</p>
<p>:param directory_path: Base folder to download files to.</p>
<p>:param key: Valid Finnhub client key.</p>
<p>:param frequency: Choose from [1, 5, 15, 30, 60, D, W, M].</p>
<p>Daily data by default.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="9111714b-beda-455f-be19-7edbd77ab82e" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#9111714b-beda-455f-be19-7edbd77ab82e');

            setTimeout(function() {
                var nbb_cell_id = 26;
                var nbb_unformatted_code = "# export\nclass FinnhubDownloader(BaseDownloader):\n    \"\"\"\n    Download financial data from Finnhub.\n\n    :param directory_path: Base folder to download files to. \\n\n    :param key: Valid Finnhub client key. \\n\n    :param frequency: Choose from [1, 5, 15, 30, 60, D, W, M]. \\n\n    Daily data by default.\n    \"\"\"\n    def __init__(self,\n                 directory_path: str,\n                 key: str,\n                 tickers: list,\n                 frequency: str = \"D\"):\n        super().__init__(directory_path=directory_path)\n        self.key = key\n        self.tickers = tickers\n        self.client = finnhub.Client(api_key=self.key)\n        self.frequency = frequency\n        self.current_time = dt.now()\n        self.end_timestamp = int(self.current_time.timestamp())\n\n    def download_inference_data(self):\n        \"\"\" Download one year of data for defined tickers. \"\"\"\n        start = self.current_time - relativedelta(years=1)\n        dataf = self.generate_full_dataf(start=start)\n        dataf.to_parquet(self.__format_default_save_path(start=start))\n\n    def download_training_data(self):\n        \"\"\" Download full date length available. \"\"\"\n        start = int(pd.to_datetime(0).timestamp())\n        dataf = self.generate_full_dataf(start=start)\n        dataf.to_parquet(self.__format_default_save_path(start=start))\n\n    def generate_full_dataf(self, start: int) -> pd.DataFrame:\n        \"\"\" Collect all price data for list of Finnhub ticker symbols (without US). \"\"\"\n        price_datafs = []\n        with ThreadPoolExecutor(max_workers=os.cpu_count()) as executor:\n            tasks = [executor.submit(self.generate_stock_dataf, ticker, start) for ticker in self.tickers]\n            for task in tqdm(concurrent.futures.as_completed(tasks),\n                             total=len(self.tickers),\n                             desc=\"Finnhub price data extraction\"):\n                price_datafs.append(task.result())\n        return pd.concat(price_datafs)\n\n    def generate_stock_dataf(self, ticker: str, start: dt) -> pd.DataFrame:\n        \"\"\"\n        Generate Price DataFrame for a single ticker.\n        ticker: Finnhub ticker symbol (without US).\n        start: Datetime object denoting starting time.\n        \"\"\"\n        candles = self.client.stock_candles(ticker,\n                                            self.frequency,\n                                            int(start.timestamp()),\n                                            self.end_timestamp)\n        try:\n            stock_df = pd.DataFrame(candles)\n        except:\n            return pd.DataFrame()\n        stock_df['ticker'] = ticker\n        stock_df['date'] = pd.to_datetime(stock_df['t'], unit='s', origin='unix').map(lambda x: x.strftime('%Y-%m-%d'))\n        stock_df = stock_df.drop(['s', 't'], axis=1)\n        return stock_df\n\n    def __format_default_save_path(self, start: dt):\n        return f\"{self.dir}/finnhub_{start.strftime('%Y%m%d')}_{self.current_time.strftime('%Y%m%d')}.parquet\"";
                var nbb_formatted_code = "# export\nclass FinnhubDownloader(BaseDownloader):\n    \"\"\"\n    Download financial data from Finnhub.\n\n    :param directory_path: Base folder to download files to. \\n\n    :param key: Valid Finnhub client key. \\n\n    :param frequency: Choose from [1, 5, 15, 30, 60, D, W, M]. \\n\n    Daily data by default.\n    \"\"\"\n\n    def __init__(\n        self, directory_path: str, key: str, tickers: list, frequency: str = \"D\"\n    ):\n        super().__init__(directory_path=directory_path)\n        self.key = key\n        self.tickers = tickers\n        self.client = finnhub.Client(api_key=self.key)\n        self.frequency = frequency\n        self.current_time = dt.now()\n        self.end_timestamp = int(self.current_time.timestamp())\n\n    def download_inference_data(self):\n        \"\"\"Download one year of data for defined tickers.\"\"\"\n        start = self.current_time - relativedelta(years=1)\n        dataf = self.generate_full_dataf(start=start)\n        dataf.to_parquet(self.__format_default_save_path(start=start))\n\n    def download_training_data(self):\n        \"\"\"Download full date length available.\"\"\"\n        start = int(pd.to_datetime(0).timestamp())\n        dataf = self.generate_full_dataf(start=start)\n        dataf.to_parquet(self.__format_default_save_path(start=start))\n\n    def generate_full_dataf(self, start: int) -> pd.DataFrame:\n        \"\"\"Collect all price data for list of Finnhub ticker symbols (without US).\"\"\"\n        price_datafs = []\n        with ThreadPoolExecutor(max_workers=os.cpu_count()) as executor:\n            tasks = [\n                executor.submit(self.generate_stock_dataf, ticker, start)\n                for ticker in self.tickers\n            ]\n            for task in tqdm(\n                concurrent.futures.as_completed(tasks),\n                total=len(self.tickers),\n                desc=\"Finnhub price data extraction\",\n            ):\n                price_datafs.append(task.result())\n        return pd.concat(price_datafs)\n\n    def generate_stock_dataf(self, ticker: str, start: dt) -> pd.DataFrame:\n        \"\"\"\n        Generate Price DataFrame for a single ticker.\n        ticker: Finnhub ticker symbol (without US).\n        start: Datetime object denoting starting time.\n        \"\"\"\n        candles = self.client.stock_candles(\n            ticker, self.frequency, int(start.timestamp()), self.end_timestamp\n        )\n        try:\n            stock_df = pd.DataFrame(candles)\n        except:\n            return pd.DataFrame()\n        stock_df[\"ticker\"] = ticker\n        stock_df[\"date\"] = pd.to_datetime(stock_df[\"t\"], unit=\"s\", origin=\"unix\").map(\n            lambda x: x.strftime(\"%Y-%m-%d\")\n        )\n        stock_df = stock_df.drop([\"s\", \"t\"], axis=1)\n        return stock_df\n\n    def __format_default_save_path(self, start: dt):\n        return f\"{self.dir}/finnhub_{start.strftime('%Y%m%d')}_{self.current_time.strftime('%Y%m%d')}.parquet\"";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6.-Custom-Downloader">6. Custom Downloader<a class="anchor-link" href="#6.-Custom-Downloader"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We invite the Numerai Community to implement new downloaders for this project using interesting APIs.</p>
<p>These are especially important for creating innovative Numerai Signals models.</p>
<p>A new Downloader can be created by inheriting from <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a>. You should implement methods for <code>.download_inference_data</code> and <code>.download_training_data</code> so every downloader has a common interface. Below you will find a template for a new downloader.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="AwesomeCustomDownloader" class="doc_header"><code>class</code> <code>AwesomeCustomDownloader</code><a href="https://github.com/crowdcent/numerblox/tree/master/numerblox/download.py#L562" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>AwesomeCustomDownloader</code>(<strong><code>directory_path</code></strong>:<code>str</code>) :: <a href="/numerbloxdownload.html#BaseDownloader"><code>BaseDownloader</code></a></p>
</blockquote>
<p>TEMPLATE -
Download awesome financial data from who knows where.</p>
<p>:param directory_path: Base folder to download files to.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




<div id="3762d0df-97b8-475a-b3a7-94007a54b4dd" class="output_subarea output_javascript ">
<script type="text/javascript">
var element = $('#3762d0df-97b8-475a-b3a7-94007a54b4dd');

            setTimeout(function() {
                var nbb_cell_id = 27;
                var nbb_unformatted_code = "# export\nclass AwesomeCustomDownloader(BaseDownloader):\n    \"\"\"\n    TEMPLATE -\n    Download awesome financial data from who knows where.\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\" (minimal) weekly inference downloading here. \"\"\"\n        ...\n\n    def download_training_data(self, *args, **kwargs):\n        \"\"\" Training + validation dataset downloading here. \"\"\"\n        ...";
                var nbb_formatted_code = "# export\nclass AwesomeCustomDownloader(BaseDownloader):\n    \"\"\"\n    TEMPLATE -\n    Download awesome financial data from who knows where.\n\n    :param directory_path: Base folder to download files to.\n    \"\"\"\n\n    def __init__(self, directory_path: str):\n        super().__init__(directory_path=directory_path)\n\n    def download_inference_data(self, *args, **kwargs):\n        \"\"\"(minimal) weekly inference downloading here.\"\"\"\n        ...\n\n    def download_training_data(self, *args, **kwargs):\n        \"\"\"Training + validation dataset downloading here.\"\"\"\n        ...";
                var nbb_cells = Jupyter.notebook.get_cells();
                for (var i = 0; i < nbb_cells.length; ++i) {
                    if (nbb_cells[i].input_prompt_number == nbb_cell_id) {
                        if (nbb_cells[i].get_text() == nbb_unformatted_code) {
                             nbb_cells[i].set_text(nbb_formatted_code);
                        }
                        break;
                    }
                }
            }, 500);
            
</script>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>


